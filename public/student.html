<html>
    <head>
        <title>Kendo School</title>
        <script src="/js/aframe-v0.8.2.min.js"></script>
        <script src="/js/aframe-physics-system.min.js"></script>
        <script src="/js/aframe-physics-extras.min.js"></script>
        <script src="js/event-manager.js"></script>
    </head>
    <body>
        <a-scene physics="debug: true; maxInterval: 0.01; iterations: 20; restitution: 0.1">
            <a-assets>
                <!-- Textures -->
                <img id = "skymap" src = "/assets/textures/nightSky.png">

                <!-- Proxy Models -->
                <a-asset-item id="dojo-obj" src="/assets/models/proxyModels/proxyModels_obj/KendoGakko_Dojo_PROXY_v003.obj"></a-asset-item>
                <a-asset-item id="shinai-obj" src="/assets/models/proxyModels/proxyModels_obj/KendoGakko_Shinai_PROXY_v003.obj"></a-asset-item>
                <a-asset-item id="dummy-obj" src="/assets/models/proxyModels/proxyModels_obj/KendoGakko_Dummy_PROXY_v002.obj"></a-asset-item>
            </a-assets>

            <!-- Camera & VR Hands Rig -->
            <!-- User POV = ~1.8m (6ft) base height + ~0.4m raised platform) -->
            <a-entity   id ="camera-rig"
                        position="0 0.4 0"
            >
                <!-- User Perspective -->
                <a-entity   id="head"
                            camera
                            look-controls
                            position="0 1.6 1.05"
                ></a-entity>
                
                <!-- VR hand-controls (FireFox Only) -->
                <!-- Left Hand -->
                <a-entity   id="handLeft"
                            hand-controls="left"
                >
                    <a-entity   id="handLeft-box"
                                physics-collider
                                static-body
                                position="0 -0.02 0.045"
                                rotation="0 0 0"
                                geometry="primitive: box;
                                            height: 0.03;
                                            width: 0.08;
                                            depth: 0.09;"
                                material="color: #e74c3c;
                                            visible: false;
                                            wireframe: true;"
                    ></a-entity>
                </a-entity>

                <!-- Right Hand -->
                <a-entity   id="handRight"
                            hand-controls="right"
                >
                    <a-entity   id="handRight-box"
                                physics-collider
                                static-body          
                                position="0 -0.02 0.045"
                                rotation="0 0 0"
                                geometry="primitive: box;
                                            height: 0.03;
                                            width: 0.08;
                                            depth: 0.09;"
                                material="color: #e74c3c;
                                            visible: false;
                                            wireframe: true;"
                    ></a-entity>
                </a-entity>
            </a-entity>

            <!-- Ground Planes -->
            <a-plane    id="groundPlane-platform"
                        static-body
                        position="0 0.6 0"
                        rotation="90 0 0"
                        width="3.658"
                        height="3.658"
            ></a-plane>
            <a-plane    id="groundPlane-floor"
                        static-body
                        position="0 0 0"
                        rotation="90 0 0"
                        width="12.192"
                        height="21.336"
            ></a-plane>
            
            <!-- Lights -->
            <a-entity   light = "type: point;
                                 intensity: 0.8;
                                 color: #bbb;
                                 castShadow: true;
                                 shadowBias: -0.000001;
                                 shadowMapWidth: 1024;
                                 shadowMapHeight: 1024;"
                        position = "0 4 0"
            ></a-entity>
            <a-entity   light = "type: ambient;
                                 intensity: 0.06;
                                 color: #bbb;"
            ></a-entity>
            
            <!-- Proxy Models -->
            <a-entity   id="dojo"
                        obj-model="obj: #dojo-obj"
                        scale="1.0 1.0 1.0"
                        position="0 0 0"
                        material="color: #bdc3c7;
                                  roughness: 0.7;
                                  metalness: 0;"
                        shadow="cast: true;
                                receive: true;"
            ></a-entity>

            <!--dummy-->
            <a-entity   id="dummy-rig"
                        position="0 1.55 -1.0"
            >
                <a-entity   id="dummy-box"
                            dynamic-body="mass: 200;
                                          linearDamping: 0.02;"
                            geometry="primitive: box;
                                      height: 1.7;
                                      width: 0.19;
                                      depth: 0.19;"
                            material="color: #FFFFFF;
                                      visible: false;
                                      wireframe: true;"
                >
                    <a-entity   id="dummy"
                                obj-model="obj:#dummy-obj"
                                position="0 -0.85 0"
                                scale="1.0 1.0 1.0"
                                rotation="0 90 0"
                                material="color:#bdc3c7;
                                          roughness: 0.7;
                                          metalness: 0;"
                    ></a-entity>
                </a-entity>
            </a-entity>
            
            <!--shinai-->
            <!--blade hit box-->
            <a-entity   id="shinai-box"
                        dynamic-body
                        position="0 2 0.250"
                        rotation="0 0 -90"
                        geometry="primitive:cylinder;
                                    height: 1.41;
                                    radius: 0.025;
                                    segmentsRadial: 12;
                                    segmentsHeight: 1;"
                        material="color: #FFFFFF;
                                    visible: false;
                                    wireframe: true;"
            >
                <!--object model-->
                <a-entity   id="shinai"
                            obj-model="obj: #shinai-obj"
                            scale="1.0 1.0 1.0"
                            position="0.7585 -0.705 0"
                            material="color: #bdc3c7;
                                        roughness: 0.7;
                                        metalness: 0;"
                ></a-entity>
            </a-entity>

            <!-- Sky Dome -->
            <a-entity   id = "sky"
                        geometry = "primitive: sphere;
                                    radius: 500;"
                        material = "shader: flat;
                                    src: #skymap;
                                    side: back;
                                    height: 2048;
                                    width: 2048;"
            ></a-entity>

            <!-- Event Handler -->
            <a-entity   id="Chandler"
                        event-manager
            ></a-entity>
       </a-scene>
    </body>
</html>