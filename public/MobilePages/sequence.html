<!DOCTYPE HTML>
<html>
    <head>
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
        <meta name="HandheldFriendly" content="true" />
        <link href="style.css" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Montserrat:100,200,300,400" rel="stylesheet">
        <script src="/socket.io/socket.io.js"></script>
        <script>
            //socketio networking
            let socket = io();

            window.onload = function () {
                socket.emit('clear');
                let table = document.getElementById("tableID");
                console.log(table)
                if (table != null) {
                    for (let i = 0; i < table.rows.length; i++) {
                        for (let j = 0; j < table.rows[i].cells.length; j++)
                        table.rows[i].cells[j].onclick = function () {
                            console.log(this.id)
                            socket.emit(this.id);
                            mark(this);
                        };
                    }
                }            
            }

            function mark(tableCell) {
                let img = document.getElementById(tableCell.id+'Notif');
                if (img.style.visibility === "visible" && img.innerHTML !== "10") {
                    img.innerHTML = parseInt(img.innerHTML) + 1;
                } else  {
                    img.style.visibility = "visible";
                }
            };

            socket.on('send', function(){
                window.location.href='waiting.html';
            });

             socket.on('clear', function(){
                var table = document.getElementById("tableID");
                console.log(table)
                if (table != null) {
                    for (var i = 0; i < table.rows.length; i++) {
                        for (var j = 0; j < table.rows[i].cells.length; j++) {
                            cell = table.rows[i].cells[j];
                            notif = document.getElementById(cell.id+'notif');
                            notif.style.visibility = "hidden";
                            notif.innerHTML = "1";
                        }
                    }
                }
            });

            //built in event
            socket.on('connect', function(userData){
                console.log('connected');
            });

            socket.on('send', function(){
                window.location.href='waiting.html';
            });

        </script>
    </head>
    <body>
        <div class="top-left">
            <img src="images/logokendo.png" class="small-image"> 
        </div>
        <div class="right-icon">
            <img src="images/sendicon.png" class="sequence-image" onclick="socket.emit('send')">
        </div>
        <div class="bottom-left">
            <img src="images/clearicon.png" class="sequence-image" onclick="socket.emit('clear')">
        </div>
        <div class="center-screen">
            <h2> SELECT THE DESIRED SEQUENCE FOR YOUR STUDENT </h2>
            <table id="tableID" class="sequence">
                <tr>
                    <td id="head">
                        <div id="headNotif" class="notification">1</div>
                        <img src="images/head_text.png" class="sequence-image"> 
                    </td>
                    <td id="neck">
                        <div id="neckNotif" class="notification">1</div>
                        <img src="images/neck_text.png" class="sequence-image"> 
                    </td>
                    <td id="leftArm">
                        <div id="leftArmNotif" class="notification">1</div>
                        <img src="images/leftarm_text.png" class="sequence-image">
                    </td>
                    <td id="rightArm">
                        <div id="rightArmNotif" class="notification">1</div>
                        <img src="images/rightarm_text.png" class="sequence-image"> 
                    </td>
                </tr>

                <tr>
                    <td id="abdomen">
                        <div id="abdomenNotif" class="notification">1</div>
                        <img src="images/abdomen_text.png" class="sequence-image">
                    </td>
                    <td id="leftHand">
                        <div id="leftHandNotif" class="notification">1</div>
                        <img src="images/lefthand_text.png" class="sequence-image">
                    </td>
                    <td id="rightHand">
                        <div id="rightHandNotif" class="notification">1</div>
                        <img src="images/righthand_text.png" class="sequence-image"> 
                    </td>
                    <td id="leg">
                        <div id="legNotif" class="notification">1</div>
                        <img src="images/leg_text.png" class="sequence-image"> 
                    </td>
                </tr>
            </table>
        </div>
    </body>
</html>